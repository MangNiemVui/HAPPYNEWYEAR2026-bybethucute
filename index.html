<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Thiá»‡p NÄƒm Má»›i 2026 â€¢ NÄƒm Ngá» ğŸ´</title>

  <link rel="stylesheet" href="./styles.css?v=20260216" />
</head>

<body>
  <!-- Fireworks / FX -->
  <canvas id="fx" aria-hidden="true"></canvas>
  <div class="sparkles" aria-hidden="true"></div>

  <!-- Decorative layer (CSS animation, not GIF) -->
  <div class="lantern lantern--left" aria-hidden="true">
    <img src="./image/lantern.svg" alt="" />
  </div>
  <div class="lantern lantern--right" aria-hidden="true">
    <img src="./image/lantern.svg" alt="" />
  </div>
  <div class="cloud cloud--1" aria-hidden="true"><img src="./image/cloud.svg" alt="" /></div>
  <div class="cloud cloud--2" aria-hidden="true"><img src="./image/cloud.svg" alt="" /></div>
  <div class="petals" id="petals" aria-hidden="true"></div>

  <div class="wrap">
    <div class="card">

      <!-- ===== Post-login flow overlay ===== -->
      <div class="flow hidden" id="flow" role="dialog" aria-modal="true" aria-label="TrÃ² chÆ¡i Ä‘áº§u nÄƒm">
        <div class="flowCard">
          <!-- Stage: Intro -->
          <section class="stage" id="stageIntro">
            <div class="stageHero">
              <img class="horseLogo" src="./image/horse-2026.png" alt="NÄƒm Ngá» 2026" />
            </div>
            <h2 class="stageTitle">ChÃºc Má»«ng NÄƒm Má»›i 2026</h2>
            <p class="stageSub">Äáº¿m ngÆ°á»£c Ä‘áº¿n khoáº£nh kháº¯c giao thá»«a (Táº¿t 2026)</p>

            <div class="countdown" aria-label="Bá»™ Ä‘áº¿m giá»">
              <div class="cdCell"><span id="cdDays">0</span><small>NgÃ y</small></div>
              <div class="cdCell"><span id="cdHours">00</span><small>Giá»</small></div>
              <div class="cdCell"><span id="cdMinutes">00</span><small>PhÃºt</small></div>
              <div class="cdCell"><span id="cdSeconds">00</span><small>GiÃ¢y</small></div>
            </div>

            <button class="btnPrimary" id="btnIntroStart" type="button">Báº¯t Ä‘áº§u nháº­n lá»™c âœ¨</button>
          </section>

          <!-- Stage: Bank info -->
          <section class="stage hidden" id="stageBank">
            <h2 class="stageTitle">Nháº­p thÃ´ng tin nháº­n lá»™c</h2>
            <p class="stageSub">Vui lÃ²ng nháº­p Ä‘Ãºng thÃ´ng tin Ä‘á»ƒ nháº­n lá»™c Ä‘áº§u nÄƒm nhÃ© ğŸ§§</p>

            <div class="formGrid">
              <label class="field">
                <span>TÃªn ngÃ¢n hÃ ng</span>
                <input id="bankName" type="text" placeholder="VD: Vietcombank" autocomplete="off" />
              </label>
              <label class="field">
                <span>Sá»‘ tÃ i khoáº£n</span>
                <input id="bankAccount" type="text" inputmode="numeric" placeholder="VD: 0123456789" autocomplete="off" />
              </label>
            </div>

            <div class="rowActions">
              <button class="btnPrimary" id="btnBankConfirm" type="button">XÃ¡c nháº­n</button>
              <button class="btnGhost" id="btnBankBack" type="button">Quay láº¡i</button>
            </div>

            <div class="noteBox" id="bankNote">Sau khi xÃ¡c nháº­n báº¡n sáº½ Ä‘Æ°á»£c chÆ¡i vÃ²ng quay may máº¯n ğŸ¡</div>
          </section>

          <!-- Stage: Wheel -->
          <section class="stage hidden" id="stageWheel">
            <h2 class="stageTitle">VÃ²ng quay may máº¯n</h2>
            <p class="stageSub">Chá»‰ cÃ³ 2 pháº§n quÃ : <b>VÃ²ng tay Pandora</b> & <b>Nháº«n Pandora</b> ğŸ</p>

            <div class="wheelWrap">
              <div class="wheelPointer" aria-hidden="true"></div>
              <div class="wheel" id="wheel" aria-label="VÃ²ng quay"></div>
              <div class="wheelCenter" aria-hidden="true">Lá»˜C</div>
            </div>

            <div class="rowActions">
              <button class="btnPrimary" id="btnSpin" type="button">Quay ngay</button>
              <button class="btnGhost" id="btnWheelBack" type="button">Quay láº¡i</button>
            </div>

            <div class="resultBox hidden" id="wheelResult"></div>
            <button class="btnPrimary hidden" id="btnWheelNext" type="button">Tiáº¿p tá»¥c</button>
          </section>

          <!-- Stage: Fortune -->
          <section class="stage hidden" id="stageFortune">
            <h2 class="stageTitle">Láº¯c quáº» may máº¯n</h2>
            <p class="stageSub">Láº¯c má»™t cÃ¡i lÃ  cÃ³ lá»™c liá»n tay ğŸ§§</p>

            <div class="fortuneWrap">
              <div class="envelope" id="envelope" aria-hidden="true">
                <div class="envelopeTop"></div>
                <div class="envelopeBody"></div>
                <div class="envelopeSeal">ç¦</div>
              </div>

              <div class="fortuneCard" id="fortuneCard">
                <div class="fortuneMoney" id="fortuneMoney">â€”</div>
                <div class="fortuneMsg" id="fortuneMsg">Báº¥m â€œLáº¯c quáº»â€ Ä‘á»ƒ nháº­n lá»i chÃºc.</div>
                <div class="fortuneMeta" id="fortuneMeta"></div>
              </div>
            </div>

            <div class="rowActions">
              <button class="btnPrimary" id="btnShake" type="button">Láº¯c quáº»</button>
        
            </div>

            <button class="btnPrimary hidden" id="btnFinish" type="button">XÃ¡c nháº­n âœ¨</button>
            <p class="stageSub">Báº¥m xÃ¡c nháº­n Ä‘á»ƒ bÃ© thÆ° cute nháº­n thÃ´ng tin nÃ¨ ğŸ§§</p>
          </section>
        </div>
      </div>
      <!-- ===== End flow overlay ===== -->

      <!-- ===== Lock overlay (login) ===== -->
      <div class="lock" id="lock">
        <div class="lockPanel">
          <div class="lockTitle">
            <h2>ğŸ”’ Má»Ÿ thiá»‡p báº±ng TÃŠN + Máº¬T KHáº¨U</h2>
            <span class="chip" id="chip">ChÆ°a má»Ÿ</span>
          </div>

          <div class="lockCountdown" aria-label="Äáº¿m ngÆ°á»£c">
            <span class="lcdLabel">Äáº¿m ngÆ°á»£c Táº¿t 2026:</span>
            <span class="lcdNum"><b id="cdMiniDays">0</b>d</span>
            <span class="lcdNum"><b id="cdMiniHours">00</b>:</span>
            <span class="lcdNum"><b id="cdMiniMinutes">00</b>:</span>
            <span class="lcdNum"><b id="cdMiniSeconds">00</b></span>
          </div>

          <p class="mini">
            Chá»n ngÆ°á»i cáº§n xem, nháº­p máº­t kháº©u rá»“i báº¥m <b>Má»Ÿ thiá»‡p</b>.
            Náº¿u báº¡n Ä‘Äƒng nháº­p <b>Owner</b>, báº¡n cÃ³ thá»ƒ xem thiá»‡p cá»§a ngÆ°á»i khÃ¡c mÃ  khÃ´ng cáº§n máº­t kháº©u cá»§a há».
          </p>

          <div class="row2">
            <div class="selectWrap" id="selectWrap">
              <button class="selectBtn" id="selectBtn" type="button">
                <span id="selectText"><small>Chá»n ngÆ°á»iâ€¦</small></span>
                <span>â–¾</span>
              </button>
              <div class="menu hidden" id="menu">
                <div class="menuHead">
                  <input id="search" placeholder="TÃ¬m tÃªn hoáº·c keyâ€¦" />
                </div>
                <div class="menuList" id="menuList"></div>
              </div>
            </div>

            <input id="pass" type="password" placeholder="Máº­t kháº©u" />
          </div>

          <div class="row2">
            <button id="btnUnlock" class="btnPrimary" type="button">Má»Ÿ thiá»‡p âœ¨</button>
            <button class="btnSecondary" id="btnOwnerView" type="button" disabled>Xem thiá»‡p ngÆ°á»i nÃ y (Owner)</button>
            <!-- NEW: Owner cho chÆ¡i láº¡i (local) -->
            <button class="btnSecondary" id="btnOwnerReplay" type="button" disabled>Cho chÆ¡i láº¡i ğŸ¡</button>
            <button class="btnSecondary" id="btnHint" type="button">Tip máº­t kháº©u</button>
          </div>

          <div class="row2">
            <button class="btnDanger hidden" id="btnLogout" type="button">ÄÄƒng xuáº¥t</button>
          </div>

          <div class="status" id="status">ğŸ‘‰ Chá»n ngÆ°á»i + nháº­p máº­t kháº©u Ä‘á»ƒ báº¯t Ä‘áº§u.</div>
        </div>
      </div>

      <!-- ===== Topbar ===== -->
      <div class="topbar">
        <div class="badge" id="badge">ğŸ´ Thiá»‡p NÄƒm Má»›i â€¢ NÄƒm Ngá» 2026 ğŸ</div>

        <div class="actions">
          <span class="pill">Cháº¡m / click Ä‘á»ƒ báº¯n phÃ¡o hoa ğŸ†</span>

          <div class="countdownMini" title="Äáº¿m ngÆ°á»£c tá»›i Táº¿t 2026">
            <span class="cdm"><b id="cdMiniDays2">0</b>d</span>
            <span class="cdm"><b id="cdMiniHours2">00</b>:</span>
            <span class="cdm"><b id="cdMiniMinutes2">00</b>:</span>
            <span class="cdm"><b id="cdMiniSeconds2">00</b></span>
          </div>

          <!-- NEW: nÃºt Nháº­n lá»™c (bá»‹ khÃ³a cho tá»›i khi gá»­i lá»i chÃºc) -->
          <button class="btnSecondary" id="btnOpenLuck" type="button" disabled>ğŸ Nháº­n lá»™c</button>

          <div class="musicControls" aria-label="Äiá»u khiá»ƒn nháº¡c">
            <select id="musicSelect" class="musicSelect" aria-label="Chá»n nháº¡c"></select>
            <button class="btnMusic" id="btnPrev" title="BÃ i trÆ°á»›c">â®</button>
            <button class="btnMusic" id="btnMusic" aria-label="Báº­t/Táº¯t nháº¡c">
              <span class="ico" aria-hidden="true">â–¶ï¸</span><span class="txt">PhÃ¡t nháº¡c</span>
            </button>
            <button class="btnMusic" id="btnNext" title="BÃ i tiáº¿p">â­</button>
          </div>



          <button class="btnSecondary hidden ownerBtn" id="btnOwnerLogin" type="button">ğŸ” Owner Login</button>
          <button class="btnSecondary hidden ownerBtn" id="btnOwnerLogout" type="button">ğŸ”“ Owner Logout</button>
          <button class="btnSecondary hidden ownerBtn" id="btnOwnerDashboard" type="button">ğŸ“Š Dashboard</button>
        </div>
      </div>

      <!-- NEW: hint khÃ³a game -->
      <div id="gameLockHintTop" class="gameLockHintTop" style="display:none">
        ğŸ’Œ Báº¡n hÃ£y <b>Gá»­i lá»i chÃºc</b> cho bÃ© ThÆ° cute trÆ°á»›c Ä‘á»ƒ má»Ÿ khÃ³a â€œNháº­n lá»™câ€.
      </div>

      <!-- ===== Main content ===== -->
      <div class="content">
        <div>
          <h1>ChÃºc Má»«ng NÄƒm Má»›i <span class="year" id="yearText">2026</span></h1>
          <p class="sub" id="subLine">Má»Ÿ khÃ³a xong báº¡n sáº½ tháº¥y lá»i chÃºc dÃ nh riÃªng cho báº¡n ğŸ</p>

          <div class="wishBox">
            <p class="wish" id="wish">ğŸ”’ Thiá»‡p Ä‘ang khÃ³a. HÃ£y má»Ÿ thiá»‡p Ä‘á»ƒ xem lá»i chÃºc.</p>

            <div class="row">
              <input id="viewerName" placeholder="TÃªn (tá»± Ä‘iá»n sau khi má»Ÿ)" disabled />
              <input id="yearInput" maxlength="6" inputmode="numeric" placeholder="NÄƒm (vd: 2026)" />
              <button id="btnWish" disabled type="button">Äá»•i lá»i chÃºc</button>
            </div>

            <div class="wishSend">
              <div class="wishSendHead">ğŸ’Œ Báº¡n cÃ³ muá»‘n gá»­i lá»i chÃºc Ä‘áº¿n bÃ© ThÆ° cute khÃ´ng?</div>
              <textarea id="wishMsg" rows="3" placeholder="Báº¡n hÃ£y nháº­p vÃ o Ä‘Ã¢y gá»­i lá»i chÃºc Ä‘áº¿n bÃ© ThÆ° cute nhÃ©..."></textarea>
              <div class="row">
                <button class="btnSecondary" id="btnSendWish" type="button" disabled>Gá»­i lá»i chÃºc</button>
                <small class="muted" id="wishSendHint">* Báº¥m â€œGá»­iâ€ Ä‘á»ƒ lÆ°u Firestore + gá»­i EmailJS (náº¿u Ä‘Ã£ cáº¥u hÃ¬nh).</small>
              </div>
            </div>
          </div>
        </div>

        <div class="side">
          <div class="bubble">
            <div class="blob" aria-hidden="true"></div>
            <img id="avatarImg" class="avatarImg" src="./avatars/default.pnj.jpg" alt="áº¢nh ngÆ°á»i nháº­n" />
          </div>
        </div>
      </div>

      <div class="foot">
        <label class="toggle">
          <input type="checkbox" id="auto" checked />
          Tá»± Ä‘á»™ng báº¯n phÃ¡o hoa
        </label>
        <span>Tip: Báº¥m icon play má»Ÿ nháº¡c rá»“i cÃ³ thá»ƒ chá»n nháº¡c theo danh sÃ¡ch Ä‘Ã³ muá»‘n nghe bÃ i nÃ o cÅ©ng Ä‘Æ°á»£c nhÃ³. âœ¨</span>
      </div>
    </div>
  </div>

  <!-- Owner Dashboard Modal -->
  <div id="ownerModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Owner Dashboard">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle">ğŸ“Š Owner Dashboard</div>
        <div class="modalBtns">
          <button class="btnSecondary" id="btnTabViews" type="button">LÆ°á»£t xem</button>
          <button class="btnSecondary" id="btnTabWishes" type="button">Lá»i chÃºc</button>
          <button class="btnSecondary" id="btnRefreshOwner" type="button">LÃ m má»›i</button>
          <button class="btnPrimary" id="btnCloseOwner" type="button">ÄÃ³ng</button>
        </div>
      </div>
      <div id="ownerBody" class="modalBody">Äang táº£i...</div>
    </div>
  </div>

  <!-- Tap audio overlay -->
  <div id="tapAudio" class="tapAudio hidden" role="button" aria-label="Cháº¡m Ä‘á»ƒ báº­t nháº¡c">
    <div class="tapCard">
      <div class="tapTitle">ğŸ”Š Cháº¡m Ä‘á»ƒ báº­t nháº¡c</div>
      <div class="tapSub">iPhone cáº§n thao tÃ¡c 1 láº§n Ä‘á»ƒ cho phÃ©p phÃ¡t nháº¡c ğŸ¶</div>
      <div class="tapBtn">Cháº¡m ngay âœ¨</div>
    </div>
  </div>

  <!-- Success overlay -->
  <div id="successPage" class="successPage hidden" role="dialog" aria-modal="true" aria-label="Gá»­i lá»i chÃºc thÃ nh cÃ´ng">
    <div class="successCard">
      <div class="successTick"><span>âœ…</span></div>
      <h3 class="successTitle">Gá»­i lá»i chÃºc thÃ nh cÃ´ng!</h3>
      <p class="successText">
Cáº£m Æ¡n báº¡n nÄƒm qua Ä‘Ã£ á»Ÿ bÃªn cáº¡nh tÃ´i nhÃ©.
Mong nÄƒm 2026 chÃºng ta váº«n tiáº¿p tá»¥c Ä‘á»“ng hÃ nh vá»›i nhau ğŸ’–
Báº¥m nháº­n lá»™c Ä‘á»ƒ nháº­n lÃ¬ xÃ¬ ğŸ§§ quay rá»“i khÃ´ng quay láº¡i Ä‘Æ°á»£c Ä‘Ã¢u Ä‘á»u sáº½ ra nhÆ° cÅ© nÃªn Ä‘á»«ng chÆ¡i gian nhÃ³ ğŸ’•
      </p>
      <div class="row" style="justify-content:center">
        <button id="btnSuccessLuck" class="btnSecondary" type="button">ğŸ Nháº­n lá»™c ngay</button>
        <button id="btnSuccessClose" class="btnPrimary" type="button">Quay láº¡i thiá»‡p</button>
      </div>
    </div>
  </div>

  <audio id="music" preload="metadata" loop playsinline webkit-playsinline></audio>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>

  <!-- config + services -->
  <script src="./config.js"></script>
  <script type="module" src="./services.js?v=20260216"></script>
  <script type="module" src="./app.js?v=20260216"></script>
</body>
</html>
